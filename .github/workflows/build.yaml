name: ç”Ÿæˆä¸­å›½IPæ®µIPSETè½¬å‚¨æ–‡ä»¶

on:
  workflow_dispatch:
  schedule:
    - cron:  '0 4 */3 * *'

jobs:
  build:
    name: ä»»åŠ¡
    runs-on: ubuntu-latest
    steps:
    - name: æ‹‰å–ä»£ç 
      uses: actions/checkout@v4

    - name: æ‰§è¡Œè„šæœ¬
      run: |
        sudo bash build.sh

    - name: æ„ä»¶å½’æ¡£åˆ°å‘å¸ƒåˆ†æ”¯
      run: |
          git config --local user.email "4288666+Xuchengen@users.noreply.github.com"
          git config --local user.name "å·¥ä½œæµæœºå™¨äººğŸ¤–"
          
          git fetch
          git checkout release
        
          cp -rf dist/china_cidr_ipset.txt ./
          
          git add china_cidr_ipset.txt
          git commit -am "æ›´æ–°äº$(date)"

    - name: GitHubæ¨é€
      uses: ad-m/github-push-action@v0.6.0
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        branch: release
        force: true